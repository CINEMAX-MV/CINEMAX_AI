<!DOCTYPE html>
<html lang="si">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MR.PEKSHA AI Chatbot</title>
<style>
body {
  font-family: 'Poppins', sans-serif;
  background: #0f0f0f;
  margin: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  color: #fff;
}
.chat-container {
  width: 800px;
  max-width: 95%;
  background: #1a1a1a;
  border-radius: 20px;
  padding: 20px;
  display: flex;
  flex-direction: column;
  box-shadow: 0 0 60px rgba(0,0,0,0.7);
}
#chat {
  height: 650px;
  overflow-y: auto;
  border-radius: 15px;
  padding: 15px;
  background: #121212;
  display: flex;
  flex-direction: column;
  gap: 8px;
  scroll-behavior: smooth;
}
.message {
  max-width: 80%;
  padding: 12px 18px;
  border-radius: 18px;
  line-height: 1.5;
  word-wrap: break-word;
  opacity: 0;
  animation: fadeIn 0.3s forwards;
  white-space: pre-wrap;
  transition: transform 0.2s, box-shadow 0.2s;
}
.user {
  background: linear-gradient(120deg, #007bff, #0056b3);
  align-self: flex-end;
  box-shadow: 0 4px 12px rgba(0,123,255,0.3);
}
.user:hover {
  transform: scale(1.02);
  box-shadow: 0 6px 16px rgba(0,123,255,0.5);
}
.bot {
  background: linear-gradient(120deg, #333, #555);
  align-self: flex-start;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
}
.bot:hover {
  transform: scale(1.02);
  box-shadow: 0 6px 16px rgba(0,0,0,0.5);
}
.bot img { max-width: 100%; border-radius: 10px; margin: 5px 0; }
#typingIndicator {
  font-style: italic;
  color: #aaa;
  margin-bottom: 5px;
  display: none;
}
input[type="text"] {
  padding: 14px;
  border-radius: 15px;
  border: none;
  flex: 1;
  margin-right: 8px;
  background: #2c2c2c;
  color: #fff;
}
button {
  padding: 14px 20px;
  border-radius: 15px;
  border: none;
  background: #28a745;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}
button:hover { background: #218838; }
@keyframes fadeIn { to { opacity: 1; } }
</style>
</head>
<body>

<div class="chat-container">
  <div id="chat"></div>
  <div id="typingIndicator">MR.PEKSHA is thinking...</div>
  <div style="display:flex; margin-top:10px;">
    <input type="text" id="userInput" placeholder="‡∂î‡∂∂‡∂ú‡∑ö ‡∂¥‡∂´‡∑í‡∑Ä‡∑í‡∂©‡∂∫...">
    <button onclick="sendMessage()">Send</button>
  </div>
</div>

<script>
const chat = document.getElementById("chat");
const input = document.getElementById("userInput");
const typingIndicator = document.getElementById("typingIndicator");

// Backend API endpoint (server.js run ‡∑Ä‡∑ô‡∂Ω‡∑è ‡∂≠‡∑í‡∂∫‡∑ô‡∂± folder ‡∂ë‡∂ö‡∑ö)
const API_ENDPOINT = "http://localhost:5000/chat";

async function sendMessage(msgOverride){
  const userMessage = msgOverride || input.value.trim();
  if(!userMessage) return;

  addMessage(userMessage,"user");
  input.value="";
  typingIndicator.style.display="block";

  try{
    const response = await fetch(API_ENDPOINT,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body: JSON.stringify({prompt:userMessage})
    });
    const data = await response.json();
    await simulateTyping(data.text);
  }catch(err){
    await simulateTyping("Error: Cannot reach AI server üò¢");
    console.error(err);
  }
}

async function simulateTyping(reply){
  const botDiv = document.createElement("div");
  botDiv.classList.add("message","bot");
  chat.appendChild(botDiv);

  for(let i=0;i<reply.length;i++){
    botDiv.innerText += reply.charAt(i);
    chat.scrollTop = chat.scrollHeight;
    await new Promise(r=>setTimeout(r,10));
  }

  typingIndicator.style.display="none";
  chat.scrollTop = chat.scrollHeight;
}

function addMessage(msg,sender){
  const div=document.createElement("div");
  div.classList.add("message",sender);
  div.innerText=msg;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

input.addEventListener("keypress", e=>{ if(e.key==="Enter") sendMessage(); });
</script>

</body>
</html>
